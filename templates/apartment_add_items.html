<!DOCTYPE html>
<html>
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
	<title>Apartment | GrütteCloud</title>
	<meta name="google-site-verification" content="gEiw9Swqs11DLP3QTgR8Y6hHGjQnhSWWud7LivLEmHs" />
	<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,700,0,200" />
	<link rel="stylesheet" href="https://www.gruettecloud.com/static/stylesheet.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
    <link rel="icon" href="https://www.gruettecloud.com/static/gruettecloud_logo.png">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        .scrollable-section {
            overflow-y: auto;
            border-radius: 40px;
            overflow: auto;
            width: 80%;
            height: 90svh;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }

        /* For WebKit (Chrome and Safari) */
        .scrollable-section::-webkit-scrollbar {
            width: 10px;
        }

        .scrollable-section::-webkit-scrollbar-thumb {
            background: var(--secondary-color);
            border-radius: 30px;
        }

        .scrollable-section::-webkit-scrollbar-thumb:hover {
            background: var(--primary-color); /* Change the thumb color on hover */
        }

        .product-item {
            display: flex;
            flex-direction: row;
            align-items: center;
            padding: 10px;
            cursor: pointer;
            border-radius: 30px;
          }
      
          .product-item.selected {
            background-color: var(--secondary-color);
          }
      
          .product-image {
            max-height: 50px;
            border-radius: 50%;
            max-width: 50px;
            margin-right: 10px;
          }
      
          .product-details {
            display: flex;
            align-items: center;
          }
        </style>
</head>
<body>
	<div class="header">
        <div class="dark-mode-toggle">
            <a href="/" class="white-button-blue-on-hover" title=""><span class="material-symbols-outlined">arrow_back_ios_new</span></a>&nbsp;&nbsp;&nbsp;&nbsp;
            <span id="darkModeToggle" class="material-symbols-outlined white-button-blue-on-hover" title="Darkmode">light_mode</span>
        </div>
		<div class="centered-content">
            <a href="/" class="logo" title="Home">
                <img src="https://www.gruettecloud.com/static/gruettecloud_logo.png" style="width: 40px; height: 40px;" title="GrütteCloud">
            </a>
        </div>
        {% include "components/nav-element.html" %}
	</div>


	<div style="text-align: center; padding: 20px; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh;">
        <h1 style="font-size: 3em;">Add Product Link</h1>
        <input type="text" id="urlInput" placeholder="Product Link" style="width: 50%; padding: 10px; border-radius: 5px; border: 1px solid #ccc; margin: 10px 0px;">
        
        <div class="scrollable-section" style="padding: 5px;">
            <hr style="border: 1px solid var(--box-shadow-color); border-radius: 5px; margin-left: 25px; margin-right: 25px;">
            <!--<div class="product-item" onclick="toggleCheckbox(this)">
                <input type="checkbox" id="{{ item["name"] }}" name="{{ item["name"] }}" value="{{ item["price"] }}" style="display: none;">
                <label for="{{ item["name"] }}" style="width: 100%; display: flex; align-items: center;">
                    <img src="{{ item["img"] }}" alt="{{ item["name"] }}" class="product-image">
                    <span class="product-details">{{ item["name"] }} | {{ item["description"] }} | {{ item["price"] }}</span>
                </label>
            </div>-->
            <div id="searchResults"></div>

        </div>
    </div>
    
	<div id="cookie-banner"></div>
    {% include "components/footer.html" %}
</body>
</html>

<script>
    // Function to perform AJAX request on input change
    $('#urlInput').on('input', function() {
        var url = $(this).val();
        if (url !== "") {
            // Encode the URL
            var encodedUrl = encodeURIComponent(url);

            // Perform an AJAX request to the server
            $.ajax({
                url: '/search_product/' + encodedUrl,
                method: 'GET',
                dataType: 'json',
                success: function(response) {
                    // Display the images dynamically
                    displayImages(response.images);
                },
                error: function(xhr, status, error) {
                    // Log or display the error message and status code
                    console.error('Error:', error);
                    console.error('Status Code:', xhr.status);
                    $('#searchResults').text('An error occurred.');
                }
            });
        } else {
            // Clear the search results if the input is empty
            $('#searchResults').empty();
        }
    });

    // Function to display the images dynamically
    function displayImages(images) {
        var imagesDiv = $('#searchResults');
        imagesDiv.empty(); // Clear previous results

        // Create an image selector form
        var imageForm = $('<form id="imageForm" action="/submit_image" method="post">');

        // Iterate through the images and create HTML elements for each
        for (var i = 0; i < images.length; i++) {
            var imageUrl = images[i];
            var imageElement = $('<div class="product-item" onclick="toggleCheckbox(this)">' +
                '<input type="checkbox" name="selectedImage" value="' + imageUrl + '" style="display: none;">' +
                '<img src="' + imageUrl + '" alt="Product Image">' +
                '<label for="' + imageUrl + '">' +
                '<span class="product-details">' + imageUrl + '</span>' +
                '</label>' +
                '</div>');
        }

        // Add a submit button
        imageForm.append('<input type="submit" value="Submit">');

        // Append the image form to the results div
        imagesDiv.append(imageForm);
    }
</script>





<script src="https://www.gruettecloud.com/static/cookies.js"></script>
<script src="https://www.gruettecloud.com/static/darkmode.js"></script>